<aaa:AAAInfo xmlns:aaa="http://www.datapower.com/AAAInfo">
    <aaa:FormatVersion>1</aaa:FormatVersion>
    <aaa:Filename>NAVDefaultAAA_Intern2Sensitiv.xml</aaa:Filename>
    <aaa:Summary>Map credentials from internal to sensitive security domain</aaa:Summary>
    <!-- Determine credential from output of the extract-identity phase. -->
    <!-- PSELV system user -->
    <aaa:Authenticate>
        <aaa:DN>${frontsideUserDNPSELVLC}</aaa:DN>
        <aaa:OutputCredential>PSELVAuthenticatedUser</aaa:OutputCredential>
    </aaa:Authenticate>
    <aaa:Authenticate>
        <aaa:DN>${frontsideUserDNPSELVUC}</aaa:DN>
        <aaa:OutputCredential>PSELVAuthenticatedUser</aaa:OutputCredential>
    </aaa:Authenticate>
    <!-- DineUTbetalinger system user -->
    <aaa:Authenticate>
        <aaa:DN>${SBLUTBWPSfrontsideUserDineutbLC}</aaa:DN>
        <aaa:OutputCredential>SBLUTBWPSUserDineutb</aaa:OutputCredential>
    </aaa:Authenticate>
    <aaa:Authenticate>
        <aaa:DN>${SBLUTBWPSfrontsideUserDineutbUC}</aaa:DN>
        <aaa:OutputCredential>SBLUTBWPSUserDineutb</aaa:OutputCredential>
    </aaa:Authenticate>
    <!-- FellesInnlogging system user-->
    <aaa:Authenticate>
        <aaa:Username>${SBLUTBWPSfrontsideUsernameFellesInnloggingLC}</aaa:Username> 
        <aaa:OutputCredential>authenticatedSBLUTBWPSUser</aaa:OutputCredential>
    </aaa:Authenticate>
    <aaa:Authenticate>
        <aaa:Username>${SBLUTBWPSfrontsideUsernameFellesInnloggingUC}</aaa:Username> 
        <aaa:OutputCredential>authenticatedSBLUTBWPSUser</aaa:OutputCredential>
    </aaa:Authenticate>
    <!-- DittNAV system user -->
    <aaa:Authenticate>
        <aaa:Username>${SBLUTBWPSfrontsideUserDittNAVLC}</aaa:Username> 
        <aaa:OutputCredential>authenticatedSBLUTBWPSUser</aaa:OutputCredential>
    </aaa:Authenticate>
    <aaa:Authenticate>
        <aaa:Username>${SBLUTBWPSfrontsideUserDittNAVUC}</aaa:Username> 
        <aaa:OutputCredential>authenticatedSBLUTBWPSUser</aaa:OutputCredential>
    </aaa:Authenticate>
	<!--  DinSak system user -->
	<aaa:Authenticate>
		<aaa:Username>${SBLUTBWPSfrontsideUsernameDinSakLC}</aaa:Username>
		<aaa:OutputCredential>authenticatedSBLUTBWPSUser</aaa:OutputCredential>
	</aaa:Authenticate>
	<aaa:Authenticate>
		<aaa:Username>${SBLUTBWPSfrontsideUsernameDinSakUC}</aaa:Username>
		<aaa:OutputCredential>authenticatedSBLUTBWPSUser</aaa:OutputCredential>
	</aaa:Authenticate>
    <!-- Specify credential (if any) to use when there is no authenticated identity. -->
    <!-- Map credentials to different credentials. -->
    <!-- PSELV system user mapping from internal zone to sensitive zone -->
    <aaa:MapCredentials>
        <aaa:InputCredential>${frontsideUserDNPSELVLC}</aaa:InputCredential>
        <aaa:OutputCredential>${backsideUserDNPSELV}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <aaa:MapCredentials>
        <aaa:InputCredential>${frontsideUserDNPSELVUC}</aaa:InputCredential>
        <aaa:OutputCredential>${backsideUserDNPSELV}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <!-- DineUtbetalinger system user mapping from internal zone to sensitive zone -->
    <aaa:MapCredentials>
        <aaa:InputCredential>${SBLUTBWPSfrontsideUserDineutbLC}</aaa:InputCredential>
        <aaa:OutputCredential>${SBLUTBWPSbacksideUserDNDineutb}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <aaa:MapCredentials>
        <aaa:InputCredential>${SBLUTBWPSfrontsideUserDineutbUC}</aaa:InputCredential>
        <aaa:OutputCredential>${SBLUTBWPSbacksideUserDNDineutb}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <!-- FellesInnlogging system user mapping from internal zone to sensitive zone -->
    <aaa:MapCredentials>
        <aaa:InputCredential>${SBLUTBWPSfrontsideUsernameFellesInnloggingLC}</aaa:InputCredential>
        <aaa:OutputCredential>${SBLUTBWPSbacksideUserDNFellesInnlogging}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <aaa:MapCredentials>
        <aaa:InputCredential>${SBLUTBWPSfrontsideUsernameFellesInnloggingUC}</aaa:InputCredential>
        <aaa:OutputCredential>${SBLUTBWPSbacksideUserDNFellesInnlogging}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <!-- DittNAV system user mapping from internal zone to sensitive zone -->
    <aaa:MapCredentials>
        <aaa:InputCredential>${SBLUTBWPSfrontsideUserDittNAVLC}</aaa:InputCredential>
        <aaa:OutputCredential>${SBLUTBWPSbacksideUserDNDittNAV}</aaa:OutputCredential>
    </aaa:MapCredentials>
    <aaa:MapCredentials>
        <aaa:InputCredential>${SBLUTBWPSfrontsideUserDittNAVUC}</aaa:InputCredential>
        <aaa:OutputCredential>${SBLUTBWPSbacksideUserDNDittNAV}</aaa:OutputCredential>
    </aaa:MapCredentials>
	<!--  DinSak system user mapping from internal zone to sensitive zone -->
	<aaa:MapCredentials>
		<aaa:InputCredential>${SBLUTBWPSfrontsideUsernameDinSakLC}</aaa:InputCredential>
		<aaa:OutputCredential>${SBLUTBWPSbacksideUserDNDinSak}</aaa:OutputCredential>
	</aaa:MapCredentials>
	<aaa:MapCredentials>
		<aaa:InputCredential>${SBLUTBWPSfrontsideUsernameDinSakUC}</aaa:InputCredential>
		<aaa:OutputCredential>${SBLUTBWPSbacksideUserDNDinSak}</aaa:OutputCredential>
	</aaa:MapCredentials>
    <!-- Determine resource from output of the extract-resource phase. -->
    <!-- Authorize access to resource for credentials. -->
    <aaa:Authorize>
    	<!-- deny access for PSELV user to DineUtbetalinger services -->
        <aaa:InputCredential>${backsideUserDNPSELV}</aaa:InputCredential>
        <aaa:InputResource>${SBLUTBWPSURIDineutb}</aaa:InputResource>
        <aaa:Access>deny</aaa:Access>
    </aaa:Authorize>
    <aaa:Authorize>
    	<!-- allow access to all other services -->
        <aaa:InputCredential>${backsideUserDNPSELV}</aaa:InputCredential>
        <aaa:InputResource>/*</aaa:InputResource>
        <aaa:Access>allow</aaa:Access>
    </aaa:Authorize>
    <aaa:Authorize>
    	<!-- allow access to DineUtbetalinger service for DineUtbetalinger consumer -->
        <aaa:InputCredential>${SBLUTBWPSbacksideUserDNDineutb}</aaa:InputCredential>
        <aaa:InputResource>${SBLUTBWPSURIDineutb}</aaa:InputResource>
        <aaa:Access>allow</aaa:Access>
    </aaa:Authorize>
    <aaa:Authorize>
    	<!-- allow access to DineUtbetalinger service for FellesInnlogging consumer -->
        <aaa:InputCredential>${SBLUTBWPSbacksideUserDNFellesInnlogging}</aaa:InputCredential>
        <aaa:InputResource>${SBLUTBWPSURIFellesInnlogging}</aaa:InputResource>
        <aaa:Access>allow</aaa:Access>
    </aaa:Authorize>
    <aaa:Authorize>
    	<!-- allow access to DineUtbetalinger service for DittNAV consumer -->
        <aaa:InputCredential>${SBLUTBWPSbacksideUserDNDittNAV}</aaa:InputCredential>
        <aaa:InputResource>${SBLUTBWPSURIDittNAV}</aaa:InputResource>
        <aaa:Access>allow</aaa:Access>
    </aaa:Authorize>
	<aaa:Authorize>
		<!--  allow access to DineUtbetalinger service for DinSak consumer -->
		<aaa:InputCredential>${SBLUTBWPSbacksideUserDNDinSak}</aaa:InputCredential>
		<aaa:InputResource>${SBLUTBWPSURIDinSak}</aaa:InputResource>
		<aaa:Access>allow</aaa:Access>
	</aaa:Authorize>
</aaa:AAAInfo>