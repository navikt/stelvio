STELVIO CHANGELOG
=================
https://confluence.adeo.no/display/stelvio/Application+Framework+-+Change+Log

Version 6.0.0
----------------------------------
- Migrate to OpenLiberty/OpenJDK
-- Replaced WAS thinclients with Liberty APIs etc
-- Removed ConsumerFacadeBase (JAX-RPC)

Version 5.0.12
----------------------------------
PL-1012: Updated Spring Web Flow to 2.4.8

Version 5.0.11
----------------------------------
PL-1005: Updated Spring Batch to 3.0.10

Version 5.0.10
----------------------------------
PL-997: Updated Spring to 4.3.25

Version 5.0.7
----------------------------------
PEN-16617: Revert

Version 5.0.6
----------------------------------
PEN-16617: Removal/upgrade of supporting libs

Version 5.0.5
----------------------------------
PK-55549: Enabled ConsumerFacadeBase to be a bit more extensible.
- Maintenance
---- StelvioContextHandler sets a transaction-id in case no context is received
---- Added @Override where applicable
---- Migrated to diamond-operator
---- Removed redundant null-initializers

Version 5.0.4
----------------------------------
PK-50808: Revert

Version 5.0.3
----------------------------------
PK-52257, PEN-14444, PK-50808: Endret logout-funksjonalitet


Version 5.0.2
----------------------------------
PK-52257 PEN-14444:
- Added check for empty string in NorskKontonummerValidator.validate

Version 5.0.0
----------------------------------
PK-33704:
- Upgrade of Java from Java 6 to Java 8

Version 4.1.13
----------------------------------
PK-46277:
- Logic fix to ExecuteServiceRequestInterceptor, and a version of it for the DTO layer is added.

Version 4.1.10
----------------------------------
PK-46277:
- ExecuteServiceRequestInterceptor now removes the RequestContext from the thread after the target operation has been completed.
- PrepareServiceRequestInterceptor collects the RequestContext in advance and re-registers it after the target operation has been completed

Version 4.1.9
----------------------------------
PK-46277:
- ExecuteServiceRequestInterceptor to log which operation is invoked if no RequestContext is provided


Version 4.1.8
----------------------------------
PEN-7860:
- Added step to revoke SSO cookie when Subject-bound nav-esso differs with request-bound nav-esso

Version 4.1.7
----------------------------------
PK-16186:
- Amended stopBatch with capability to terminate multiple concurrent job instances.

Version 4.1.6
----------------------------------
PK-13845:
- Introduced fix to better handle remote service invocations with no RequestContext (StelvioContext). A default RequestContext will now be assigned when RequestConetxt is missing.

Version 4.1.5
----------------------------------
PKIGUAN-857/PK-12734:
- The new test failed due to Linux being case-sensitive on filenames while Windows isn't. Changed the new xml-resource filename to lowercase.


Version 4.1.4
----------------------------------
PKIGUAN-857/PK-12734:
- Changed no.stelvio.batch.controller.support.SpringBatchEnabledBatchControllerService to put a generated transactionId and componentId on RequestContext. Previously only added userId.
- Added test of SpringBatchEnabledBatchControllerService's RequestContext.

Other:
- Updated .../app/stelvio-batch-java/pom.xml to depend on slf4j-log4j12 to remove warnings (SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder")
- Deleted .../app/version_number.txt


Version 4.1.3
----------------------------------
PKIGUAN-485/PK-13403:
- Reverted bugfix: bugfix introduced in 4.1.1 "Added after-invoke code in ExecuteServiceRequestInterceptor and added reset of RequestContext there"
- The bugfix above caused unexpected behavior for orchestrated services and remote service invocations with no assigned RequestContext. 


Version 4.1.2
----------------------------------
PKIGUAN-485/PKIGUAN-761:
- Bugfix: Different transactionId is logged for single request when logging contents of MDC
- Moved set/reset of MDC to RequestContextSetter
- Removed duplicate class RequestContextSetter from stelvio-provider (is in common and provider already has a dependency to common)
- Simplified logic in RequestContextFilter (before doFilter part)

Other:
- Updated some old spring config for tests

Version 4.1.1
---------------------------------- 
* Changes to improve logging using stelvio properties in MDC (PKIGUAN-485)
	- Added setting and resetting of MDC in RequestContextFilter
	- Added setting and resetting of MDC in ExecuteServiceRequestInterceptor
	- Added after-invoke code in ExecuteServiceRequestInterceptor and added reset of RequestContext there
	- Renamed Log4jLogger to MDCLogger and moved logic to new class MDCOperations
	- Fixed some Used+undeclared dependencies as reported by dependency-plugin
	- Added setting and resetting of MDC in StelvioContextHandler (used by JAX-WS providers)
	- Added tests (mockitobased) for StelvioContextHandler
	
Version 4.1.0
---------------------------------- 
* Code and dependency changes to upgrade from JSF 1.2 to JSF 2.1 (PKIGUAN-355)
* Added support for JSF ClientBehavior i custom JSF renderers (PKIGUAN-449)
* Added support for AjaxBehaviorEvent in JSF event listener classes (PKIGUAN-464)

Version 4.0.1
---------------------------------- 
New version of Spring security replaces acegi security
 
Version 4.0.0
---------------------------------- 
Technical 3. party dependency updates. 
New version of Spring framework and related libraries.
New Spring cache implementation replaces googlecode spring cache.
Spring security, spring batch, spring webflow is not upgraded in this release
Based on version 3.0.0 of stelvio, without OpenAM implementation.
Dependency cleanup, removal of unneccesary libraries, and upgrade of internal dependencies.

Version 3.1.0
----------------------------------
Module stelvio-presentation-java:
* Added filter to detect changes in nav-esso cookie (PKIGUAN-155)
* Added logoutservice that supports OpenAM (PKIGUAN-156)

Stelvio:
* Switched to maven3 for building and removed use of deprecated maven variables
* Updated maven-root-pom from 1.2.3 to 1.2.5
* Changed maven-compiler-plugin config from version 1.5 to 1.6
* Added wagon-webdav-jackrabbit to support DAV when communicating with maven repositories

Version 3.0.0
----------------------------------
Module stelvio-common-java:
* Updated ehcache version to 2.5.2 and ehcache-spring-annotations version to 1.2.0 (IRPORT-2450)

Version 2.4.0
----------------------------------
Module stelvio-common-java, stelvio-presentation-java:
* Improved code quality (IR-352/IR-353)

Module stelvio-batch-java:
* Improved error handling for stelvio batch history (IR-544)

Version 2.3.0
----------------------------------
Module stelvio-common-java:
* Rollback IRPORT-1531

Version 2.2.0 (07.05.2012) DEPRECATED! Do not use, use 2.3.0.
----------------------------------
Module stelvio-common-java:
* Fixed a bug in ExecuteServiceRequestInterceptor (IRPORT-1531)

Module stelvio-consumer:
* Added JAX-WS support (IRPORT-1490)

Module stelvio-presentation:
* Fixed a bug in CodeTableItemSelectOneMenu that resulted in duplicate entries in drop downs (IRPORT-1639)

Module stelvio-batch:
* Added the parameters that a Stelvio batch is started with to the batch history (IRPORT-993)

Version 2.1.2 (29.06.2011)
----------------------------------
Module stelvio-batch:
* Added history for stelvio batches

Version 2.1.1 (20.05.2011)
----------------------------------
Module stelvio-presentation:
* CodesTableItemSelectOneMenu fix - list of items will be filtered even though displayValueOnly is true and false for different items in a table


Version 2.1.0 (19.04.2011)
----------------------------------
Module stelvio-batch:
* Added status log for Spring Batch including hostname and current schema (SIR #NAV00228510)

Module stelvio-common:
* Removed all dependencies to Log4J, including Log4JLogFactory, LogFactoryImpl, ReloadLog4JProperties and JMSQueueAppender


Version 2.0.1 (07.04.2011)
----------------------------------
Module stelvio-common:
* Added caching to getCodesTablePeriodic() in DefaultCodesTableManger to ensure better performance (SIR #NAV00227853)
* Updated Spring modules version 0.7 in project pom with a patched version, to ensure thread safety (SIR #NAV00237193)

Module stelvio-presentation:
* Added HtmlCheckboxRenderer with style rendering for Tomahawk spread layout checkboxes

Module stelvio-batch-java:
* Fixed error in batch job parameters validator (SIR #NAV00227847)
* Added more strict date parsing for job parameters validator
* Made start and stop count operations thread safe

Version 2.0.0 (25.02.2011)
----------------------------------   
Module stelvio-presentation:
* Added attribute "validOnDate" to CodesTableItemSelectOneMenu (CR #NAV00163122, Implementation #NAV00221648)
* Added HtmlRadioRenderer for JSF (Implementation #NAV00214765)

Module stelvio-common:
* Automatic refresh of Log4j property files runtime (CR #NAV00175657, Implementation #NAV00214454)
* Updated DefaultCodesTablePeriodic getCodesTableItemsValidForDate() to check if an item is valid ("er_gyldig" = true) (CR #NAV00163122, Implementation #NAV00221648)
* Added debug logging when creating LTPA header and deprecated methods in SecrityHeader.java: setSecurityContext() and processHeader() (SIR #NAV00203650, Implementation #NAV00206811, #NAV00229444)
* Logging functionality upgraded to use SLF4J, and dependency to Log4j removed (CR #NAV00213840, Implementation #NAV00225332)
* Added code-to-cti converter, getCti(), to CodesTableManager (Implementation #NAV00214765)

Module stelvio-batch:
* Upgraded Stelvio Batch with Spring Batch (CR #NAV00202478, Implementation #NAV00222243)
* Batch counters are now thread safe (CR #NAV00224878, Implementation #NAV00227466)

Module stelvio-domain:
* Fixed error in leap years in Pid.calculateAge() (Implementation #NAV00214765)

Module stelvio-service:
* Added ehcache annotations to RepositroryCodesTableItemsFactory (Task #NAV00208231 )

Stelvio:
* Disabled Log4j logging to console for Stelvio unit tests (SIR #NAV00203024, Implementation #NAV00203026)
* Cleaned up POM's (Implementation #NAV00214765)

FRAMEWORK UPGRADES:
stelvio:
Spring WebFlow: 2.0.8.RELEASE -> 2.0.9.RELEASE
Spring Framework: 2.5.6.SEC01 -> 2.5.6.SEC02
Spring Batch: 2.1.0.RELEASE -> 2.1.3.RELEASE
Ehcache: 1.2.4 -> 1.5.0
Commons BeanUtils: 1.7.0 -> 1.8.3
Commons Lang: 2.2 -> 2.4
Commons Collections: 3.1 -> 3.2.1
Commons Digester: 1.7 -> 1.8.1
Log4j: 1.2.15 -> 1.2.16
jMock: 2.1.0 -> 2.5.1
Junit: 4.1 -> 4.8.2

stelvio-presentation:
Myfaces: 1.1.7 -> 1.2.9
Tomahawk: 1.1.6 -> 1.1.10
RichFaces: 3.3.3.Final (removed Ajax4jsf because it is now contained within RichFaces)


stelvio-consumer:
com.ibm.ws.webservices.thinclient 6.1.0 -> 7.0.0

stelvio-common:
Acegi Security Tiger: 1.0.0 -> 1.0.7
com.ibm.ws.webservices.thinclient 6.1.0 -> 7.0.0
com.ibm.ws.runtime 6.1.0 -> 7.0.0
Joda-Time: 1.2.1 -> 1.6.2


Version 1.7.1 (15.10.2010)
----------------------------------   
Module stelvio-presentation:
* Removed transient modifier for the log in PagedSortableList (SIR #NAV00204510)  

Module stelvio-consumer:
* Fixed namespace problem in ConsumerContextHandler (SIR #NAV00202164, Implementation #NAV00205224)    

stelvio
* Trace log is only executed when trace log is activated (SIR #NAV00202899)
* Getting a requestContextHolder is thread safe (SIR #NAV00199359)

Version 1.7.0 (20.09.2010)
----------------------------------
* Upgraded dozer to version 5.2.2 (CR #NAV00184584)
* Added xor possibilities to SecurityHeader.createBasicAuth() (SIR #NAV00199423)
* Added logging when base64-decoding fails in SecurityHeader. (SIR #NAV00194933)
* Added nullpointer test on externalContext in AuthenticationService.sendReAuthenticationRequest() with logging if it is null. (SIR #NAV00196971)


Version 1.6.1 (25.08.2010)
----------------------------------
Module stelvio-common:
* SIR NAV00195547: Two of the url variables in no.stelvio.common.security.ws.SecurityHeader contained spaces causing integration
  tests using user name token authentication fail when connecting to a integration service built on the new architecture.


Version 1.6 (25.06.2010)
----------------------------------
* Harvest code from PCOM into Stelvio, (#NAV00169268)
* Correct non-existing annotations (tags) used in JavaDoc. (#NAV00161362)
* Turn off log4j auto refresh, merge SIR (#NAV00169490)
* Merge changes from the 1.5.7 release
* Configure parent pom to aggregate the Javadoc into one place for all layers (#NAV000154859)
* Removed TODOs from Stelvio code (#NAV00168740, #NAV00168746, #NAV00168747, #NAV00173216, #NAV00173238, #NAV00173245,
#NAV00173250, #NAV00173251, #NAV00173253, #NAV00173254, #NAV00173256, #NAV00174087, #NAV00176874)
* Removed simple errors reported by checkstyle and findbugs (#NAV00179562)
* Removed old and unused code (#NAV00172863)

Module stelvio-batch:
* Support for Spring Batch, harvested from POPP, (#NAV00177683)
* Batch parameter validation (#NAV00146452)

Module stelvio-common:
* DateUtilTest.isSameDay fails when both dates are null (#NAV00173258)
* DateUtilTest.testFormatTimeOfDay fails when CET is not the current TimeZone (#NAV00181465)

Module stelvio-consumer
* Removed TODO's and javadoc changes in ConsumerFacadeBase (#NAV00173216)


Version 1.5.9 (26.01.2011)
----------------------------------
* Added support for Log4J autorefresh when log4j.properties is located within a jar file, see [Guideline - Common - Logging|Guideline - Common - Logging] (CR:NAV00175657)
 

Version 1.5.8 (25.01.2011)
----------------------------------
* Added Log4J autorefresh, see [Guideline - Common - Logging|Guideline - Common - Logging] (CR:NAV00175657)


Version 1.5.7 (10.03.2010)
----------------------------------
* Disable Log4j auto-refresh to handle a memory leak (SIR 165571)
   - Disable the standard thread that periodically check if the log4j.properties file have been modified (run-time refresh of log settings) since it has been causing
     memory to leak in the system
* Introduce a new listener for Commons Logging to handle a memory leak (SIR 165559)
* Remove references in SecurityContextHolder and RequestContextHolder to handle a memory leak (SIR 165563)


Version 1.5.6 (27.01.2010)
----------------------------------
Module stelvio-domain:
* Pid validation fix. D-numbers with personnumber lower then 10 are now handled (SIR 158667)


Version 1.5.5 (06.01.2010)
----------------------------------
Module stelvio-common:
* Restore Log4JLogFactory as the new replacement did not cover all requirements (SIR #NAV00155772)


Version 1.5.4 (17.12.2009)
----------------------------------
Module stelvio-presentation:
* Ensure that Stelvio ErrorPageExceptionHandler logs Exceptions to the error log (SIR #NAV00154816)


Version 1.5.3 (04.12.2009)
----------------------------------
Module stelvio-presentation:
* Update Error handling for the presentation layer (CR #NAV00147410)


Version 1.5.1 (30.11.2009)
----------------------------------
Module stelvio-dto
* Added message property to RecoverableDtoException (SIR #NAV00151777)


Version 1.5.0 (25.11.2009)
----------------------------------
Module stelvio-presentation:
* Upgrade Spring Web Flow (CR #NAV00128365, MODULE #NAV00052931, TASK #NAV00141656, TASK #141977)
* Codestables - Nullpointer in AbstractCodesTablePeriodicItem equals (SIR #NAV00131351)
* Codestables - AbstractCodesTableItemConverter's CodestablesManager-property is protected (SIR #NAV00133873)
* Context - Mapping of RequestContext doesn't work (SIR #NAV00133882)
* Security - FindBugs errors (SIR #NAV00102430)
* Security - Make JeeRole, JeeRoles and JsfPage serializable (SIR #95394)
* Code completion support for custom Stelvio JSF tags (SIR #146903)

Module stelvio-common-error
* Remove deprecated ExceptionHandlerFacade (SIR #NAV00148137)

Upgrading
There are 3 tasks involved when upgrading to Stelvio 1.5
* The deprecated ExceptionHandlerFacade have been removed
* Class loader need to be set to "parent last" for the application
* A new logFactory is used, commons-logging.properties need to be updated to reference to the new Stelvio logFactory


Version 1.2.1
----------------------------------
Module stelvio-common-security
* Fix XOR-scrambling of passwords (SIR #NAV00142776)


Version 1.2.0
----------------------------------
* Upgrade Hibernate (CR 102476)
* Upgrade Spring core version (CR 102469)

Maven
* Introduce the Mockito-framework as a test dependency (SIR 127789)
* Moose has added SNAPSHOT to a dependency erroneously (SIR 130826)


Version 1.1.1 (21.01.2010)
----------------------------------
Module stelvio-domain:
* Pid validation fix. D-numbers with personnumber lower then 10 are now handled (SIR 157117)

Upgrading
* Note that Maven 2.0.6 seems to better at handling building and testing of this Stelvio version better then newer Maven versions


Version 1.1.0 (13.05.2009)
----------------------------------
Module stelvio-common:
* Codestables - Sonar fails, must remove @SuppressWarnings-annotations inside methods (SIR #NAV00102548).

Module stelvio-domain
* The Pid class erroneously rejects persons with D-numbers that end with 0000N, where N is [00000-00009].
Correct the isGyldigFnr in the Pid class, where PIDs that validate against the mod11 check but should fail
on the special circumstance-check (i.e ends with 00000 or 00001) erroneosly are validated (CR #NAV00097658)

Maven
* Maven site fails for Stelvio (SIR #NAV00097276 )
* Maven site - configure Findbugs report (SIR #NAV00102484)
* Maven site - configure Clover report (SIR #NAV00103493)
* Maven site - configure Maven Dashboard plugin (SIR #NAV00103494)
* Moose has erroneously added SNAPSHOT to plugins in the Maven poms (SIR #NAV00124749)
* Maven correct the SCM-tag in the Stelvio_NEXT stream (SIR #NAV00127993)


Version 1.0.7.2 (06.02.2009)
----------------------------------
Module stelvio-batch:
* When calling the setters in BatchDO, the corresponding ChangeStamp object is now being updated. (SIR #NAV00075026)
* Two instances of the same batch (i.e same batch name and slice) can no longer be started while the first instance is running. (SIR #NAV00090238)

Module stelvio-common:
* Added check for null in the AbstractCodesTable.filterCodesTableItems() method, thus avoiding null pointer exception when code table doesn't exist. (SIR #NAV00082577)
* DefaultExceptionLogger - Fixed 3 errors in the logMessage() method: Throwables at severity level WARNING were not logged with context information.
  Unecessary processing was made when logging was disabled. Severity level DEBUG was checked against the WARNING loglevel and thus potentially would
  not be written to the log. (SIR #NAV00089861)
* Fixed JUnit tests. Removed the empty AllMapperTest, renamed AccessVoterManagerTests and MethodWrapperInterceptorAdvisorTests to comply with the
  naming standard (-Test suffix). Corrected error
  in MethodWrapperInterceptorAdvisorTest that used a null reference advice. (SIR #NAV00090055)
* Added methods to the ExceptionLogger for appending an arbitrary message when logging exceptions. (CR #NAV00084345)

Module stelvio-dto:
* Removed deprecated code in RecoverableDtoException and UnrecoverableDtoException. (SIR #NAV00072767)

Module stelvio-presentation:
* New mocule for detecting multiple submit of pages, a new guideline with documentation of the new solution can be found at
  http://confluence.adeo.no/display/stelvio/Guideline+-+Presentation+-+Prevent+double+submit  (SIR #NAV00029616)


Versions 1.0.6.4 and 1.0.7.1 (29.09.2008)
----------------------------------
Module stelvio-consumer:
* Updated the ConsumerFacadeBase to support username token in addition to LTPA tokens (CR#NAV00071405)

Module stelvio-common:
* Added a username token JAX-RPC handler that the ConsumerFacadeBase can use. (CR#NAV00071405)

Module stelvio-presentation
* The stelvio exception handler, ErrorPageExceptionHandler, was only added on superflows and not subflows because of a bug in ExceptionHandlerFlowExecutionListener.
  The error page specified in the spring web flow configuration of the application was not triggered when an error occured in a subflow. (SIR#NAV00068553)


Stelvio TAI Version 1.0.3
----------------------------------------
Module stelvio-security-tai
* Updated module to support reauthentication of users that can act on behalf of other users (#NAV00057888).
  This module must be installed in order to use the new "Fullmakt" functionality provided in Stelvio 1.0.7.0, however it is not built with the other modules
  in Stelvio. It can be downloaded from http://maven.adeo.no/m2internal/no/stelvio/was61/stelvio-security-tai-java/1.0.3-UTVIKLING/stelvio-security-tai-java-1.0.3-UTVIKLING.jar
  and installed as described in the guideline http://confluence.adeo.no/display/navpenutv/Oppsett+av+ny+Trust+Association+Interceptor+%28TAI%29


Version 1.0.7 (11.09.2008) - Target: Myggen
---------------------------------------------
stelvio-common-security
* SecurityContext updated with new field authorizedAs representing the userId that the current user is authorized to act on behalf of. (#NAV00057876)
* Added wrapper class, WSCustomSubject, which can be used to retrieve attributes from a custom Subject created on an IBM Websphere server. (#NAV00057876)

stelvio-presentation-security
* Added new filter, WSCustomSecurityContextFilter, which populates the SecurityContext using the WSCustomSubject class. (#NAV00057876)
* Added classes to support the functionality of reauthenticating a user to act on behalf of another user with a certain authorization type. (#NAV00057876)
* Updated the page security module to conform with the new functionality of users acting on behalf of other users. (#NAV00057876, #NAV00069124)


Version 1.0.6.3 (11.09.2008) - Target Kjempen
----------------------------------------------
Module stelvio:
* Spring 2.5 upgrade. All Spring dependencies used by Stelvio has been upgraded to Spring version 2.5.3 (SIR#NAV00051724->#NAV00058099)

Module stelvio-batch:
* Added support for stop semantics, making it possible to request that a batch is stopped from the client (TWS) side (CR#NAV00037285->#NAV00047989).
* Fixed reported error and suggested improvements to performSanityCheck in AbstractBatch (SIR#NAV35610).
* Fixed deprecated exception handling in AbstractBatch which used deprecated ExceptionhandlerFacade (SIR#NAV00038671->#NAV).
* Several fixes/enhancements to batch logging to enable batch logging to different locations/files. Added error and info loggers to AbstractBatch superclass
  that can be used for batch specific logging (SIR#NAV00052303).
* Fix to provide cause of configuration errors (InvalidPropertyException) in BatchControllerService implementation (SIR#NAV00063837).
* Added log entry on the client which logs the userid of the user that starts a batch with security (SIR#NAV00064113).


Module stelvio-common:
* Fixed deprecated implementation and use of Stelvio exception classes (#NAV00052709).

stelvio-common-cache
* Updated guidelines for caching. Caching is now set up explicitly with pointcuts and advisor from the Spring AOP schema. This will resolve problems
  reported that has to do with multiple logging of exceptions and class cast exceptions (#NAV00036532, #NAV00037360, #NAV00037403).

stelvio-common-codestables
* Updated architecture documentation, specifying in more detail how codestables should be classified and implemented (#NAV00036684).
* Moved cache annotation from interface to implementation (SIR #NAV00052481, #NAV00052584).

stelvio-common-error
* DefaultExceptionLogger now handles logging of array attributes in exceptions. It now uses the toString implementations of the array attributes and
  not only the object identifier. (#NAV00047900)
* Added new methods to ExceptionLogger to specify functional or technical logging. The default exceptionlogger has a new MDC field, errorType, that is indicates whether
  the logged error was technical or functional (SIR#NAV00052303)
* Added logging of array-attributes in exceptioonlogger (#NAV00049177).
* Improved logging in DTOExceptionLogger (#NAV00035626).
* MissingPropertyConfigurationException is updated with a better message to improve logging when it is thrown before the Spring container is initialized by
  init methods(#NAV00036555).

stelvio-common-logging
* Updated architecture documentation, general improvements and synchronizing with NDU official logging principles (#NAV00033997).
* Added InfoLogger interface, with specific Log4J implementation. The InfoLogger can be used to log messages up to INFO-level. In addition to the log message,
  the infologger supports logging context data and additional message attributes. (SIR#NAV00052303)

stelvio-common-transferobject:
* Fixed PrepareServiceRequestInterceptor to work properly with AOP(SIR#NAV00037493).

Module stelvio-consumer:
* Improvement to error handling for faults originating from the integration bus.
  Added new consumer exception supertypes:
  - WsConsumerRecoverableException
  - WsConsumerUnrecoverableException
  These should be used as supertypes for exceptions in web service calls to the integration bus, as they copy error
  information from integration Faults, and make it available in application exceptions  (#NAV00036681).


Module stelvio-dto
* Introduced errorCode and getErrorCode/setErrorCode on SystemUnrecoverableDtoException (#NAV00035626).
* Implemented toString() in DTO-classes (#NAV00047837).

Module stelvio-presentation
* Corrected an error in ErrorPageExceptionHandler that might cause a NullpointerException in some rare situations (#NAV00035406, #NAV00035551).
* Improved exception handling for consumer errors. Changed the modifier type from private to protected for helper methods in ErrorAction that
  might be convenient for subclasses (CR#NAV00037499->#NAV00038607).
* Updated FacesContextMessageSource to read resourcefile in Stelvio (#NAV00036328).
* Harvested re-usable validators created in the Pension project. The validators are documented in  Guideline - Validation - Using Stelvio validators. The
  following validators have been harvested (#NAV00025990):
  - AbstractFieldNameValidator.java
  - BbanValidator.java
  - DateRangeValidator.java
  - FirstInMonthValidator.java
  - IbanValidator.java
  - LastInMonthValidator.java
  - PidValidator.java
  - TextValidator.java

stelvio-presentation-security
* Corrected error in AuthenticationLevelHandler which in some situations might cause the page security components not to work properly
and thus allowing unauthorized access to a web page. (SIR#NAV00065105)

Module stelvio-provider:
* - DtoExceptionLogger now logs domain-type exceptions exactly as DefaultExceptionLogger.
  - DtoExceptionLogger now logs newly introduced errorCode for SystemUnrecoverableDtoException (#NAV00035626).

Module stelvio-repository
* The hibernate-annotations dependency has been upgraded from version 3.3.0.ga to 3.3.1.GA (SIR#NAV00057893)

Module stelvio-service:
* Moved codestable cache annotation from interface to implementation for RepositoryCodesTableItemsFactory (#NAV00052481)



Version 1.0.5.8 (22.04.2008) - Target: Rekrutten
-------------------------------------------------
Module stelvio-domain
* Fixed Pid to allow getFodselsdato to calculate the birthday on all valid Pids, even those that end in 0000X(NAV00036826)


Version 1.0.6.2 (03.04.2008)
----------------------------------
* Upgraded pom.xml with correct snapshot repo (#NAV00033164)
* Added the new module stelvio-batch-client-java to the parent pom.xml (#NAV00033613)

Module stelvio-batch
* Added "static" modifier to the main method of BatchControllerClient (#NAV00033501->NAV00033616)
* Removed context and properties files from src/main/resources. These should not be a part of the distribution, but there are guidelines describing what these files should
  look like. (#NAV00031460)
* Added a dependency to the newly created stelvio-batch-client-java project. (#NAV00033613)

stelvio-batch-client
* Created a new project artifact named stelvio-batch-client-java. This project will consist of code necessary for batch clients. The following classes have been moved from
  the stelvio-batch-java project to the stelvio-batch-client-java project:
  no.stelvio.batch.BatchStatus
  no.stelvio.batch.controller.BatchControllerServiceBi
  no.stelvio.batch.controller.client.*
  no.stelvio.batch.controller.client.support.*
  (#NAV00033010->#NAV00033613)


Module stelvio-common

stelvio-common-error
* Added new exception logger for logging DTO exceptions in provider layer (see Module stelvio-provider). no.stelvio.common.error.logging.ExceptionLogger has been renamed to
  no.stelvio.common.error.logging.support.DefaultExceptionLogger. ExceptionLogger is now an interface implemented by the DefaultExceptionLogger (#NAV00033004)

stelvio-common-audit
* Added new components to facilitate audit logging. no.stelvio.common.event.AuditInfo (#NAV0033445)

Module stelvio-provider
* New component no.stelvio.provider.error.logging.DtoExceptionLogger for logging of Dto exception types (#NAV00033004)

Module stelvio-presentation
* New component no.stelvio.presentation.jsf.context.FacesContextView to be used with ViewRoot for current FacesContext.
  Has functionality for clearing a UIViewRoot to be used with cancel/clear commands when skipping validation by using the immediate="true" attribute.
  If the UIViewRoot isn't cleared JSF will keep the input from UIViewRoot without reading anything from form object (#NAV00033666).
* Deprecated methods in action class  for technical error pages that used outdated error framework(#NAV00031699).


Version 1.0.6.1 (04.03.2008)
----------------------------
Module stelvio-common:

stelvio-common-error
* Backwards compatibility fix for Stelvio exceptions before 1.0.6 release (#NAV00032112).

Module stelvio-dto:
* Made message template arguments in DTO exceptions transient in order to resolve bus issues with Object arrays (#NAV00032552)

Version 1.0.6 (20.02.2008)
-----------------------------------
* New more developer friendly-error handling framework (CR #NAV00026284).
* Enhancements to Confluence documentation, specifically related to new error handling (caused by CR #NAV00026284), codestables (#NAV00020934) and validation(#NAV00006545).
* Upgraded commons-lang version from 2.0->2.2 (CR #NAV00016991).
* Maven parent POM. Cleaned up dependencies and added comments to improve traceability of what libraries are used for (#NAV00026700).
* Maven module POMs: Cleaned up dependencies and added commments (Refer to descriptions in module listings below).
* Solved ASM library version incompability between Spring and Hibernate (#NAV00026503).

Module stelvio-batch:
* Maven POM: Added dependecy to stelvio-repository-java. Moved all repository specific dependencies to stelvio-repository-java (#NAV00028352).
* New interface BatchBi for AbstractBatch (#NAV00022451)
* New component for Batch Controller and Batch Controller Client that can be used to start batch jobs.
  The purpose of using this is to have a standardised method to start and control batch jobs.
  Documented in Stelvio - Batch - Batch Controller complete with guidelines (#NAV00020332).

Module stelvio-common:
* Maven POM: Removed dependencies to joda-time, cglib_nodep and cglib. Joda-time is never used, cglib_nodep and cglib is provided through the parent POM(#NAV00026703).

stelvio-common-codestables
* Added support for sorting codestable items numerically (for both code and decode): DecodeNumericComparator and CodeNumericComparator.
  These can be used by SelectItem in web-applications to sort a list of codestable items (CR #NAV00024456).

stelvio-common-context
* Added isRequestContextSet() method to RequestContextHolder (#NAV00019614)

stelvio-common-error
* Fully re-engineered version of the common error handling framework (CR #NAV00026284)
  Main features (refer to document PP2442_DTG_4 for full details):
  - Stelvio exception message template and the use of the error definition database table to store error information is deprecated.
  - Error messages will instead be provided by developers when creating exception instances, ie exception message field.
  - Added optional ErrorCode field in unchecked system exceptions that can be used to differentiate variants of similar error situations.
  - The error handling facade, together with the error handling strategies are deprecetated, and replaced by a new error logger interceptor.

Module stelvio-presentation:
* Improved CodesTableItemSelectOneMenu by adding changes made in PCOM, and updated error handling according to the new error handling
  architecture. (#NAV00027381, #NAV00030473)
* Changed the usage of Set in CodesTableItemSelectOneMenu when sorting codes table items, it now uses List because Set does not support
  duplicates (#NAV00020882).
* Improved FacesContextMessageSource by adding features developed in PCOM, a better way of retrieving the message bundle and made it possible to
  find and add errors to components in datatables. (#NAV00027381, #NAV00030520)

stelvio-presentation-security:
* New wrapper exception for securitye xceptions which are rethrown inside the JeeSecurityPhaselistener after being handled by exception handlers (#NAV00018208)

Module stelvio-provider:
* Maven POM: Removed dependencies to stelvio-consumer, hsqldb, cglib (inherited from parent POM).
  Added test scope dependencies to aspectj/aspectjweaver, asm and asm-commons (#NAV00028002).

Module stelvio-repository:
* Maven POM: Removed dependency to hsqldb. The dependency is never used in the stelvio-repository module. (#NAV00028170)
       Removed dependency to stelvio-common and removed ConsumerSystemExceptionTest (#NAV00028290)
       Exluded asm, asm-attrs and cglib transitive dependencies from hibernate and spring-hibernate dependencies, added repository specific
       dependencies from stelvio-batch-java (#NAV00028170, #NAV00028352)
* HibernateCodesTableRepository uses a query with FlushMode.MANUAL when querying for CodesTableItems (#NAV00030400 & #NAV00030392)

Module stelvio-service
* Maven POM: Added a test scoped dependency to hsqldb, because hsqldb is no longer provided by stelvio-repository a test scoped dependency to
  hsqldb is needed to run junit tests (#NAV00028222)

Stelvio/inf:
Module stelvio-security-tai:
* New module for TAI integration with WebSEAL(#NAV00017103). This is should not be used by applications yet!


Version 1.0.5.7 (03.01.2008)
----------------------------
Module stelvio-common:
* Added AbstractDozerMapper, holding a dozer mapper reference. To be inherited by custom mappers (#NAV00024461).

Module stelvio-domain:
* getFodselsdato() in Pid throws PidValidationException if containing an invalid birth date(#NAV00019355).
* Override toString in Pid(#NAV00020424).
* New method isDnummer() in Pid that checks if the Pid could be a Dnummer(#NAV00026609).

Module stelvio-presentation:
stelvio-presentation-security
* Bug (SIR#NAV00019574) in WebsealLogoutService corrected, added a new property which should contain the absolute url to the first point of contact host
  (e.g. BigIP or WebSEAL).(#NAV00024983)

Module stelvio-provider:
* Simplified mappers (ChangeStampMapper, RequestContextMapper, SecurityContextMapper) by inheriting AbstractDozerMapper (#NAV00024461).
* Deprecated AbstractDozerMapper, replaced by stelvio-common equivalent (#NAV00024461).
* Added custom converters for codes table items, periodic and non-periodic (#NAV00006784).
* Deprecated CodesTableItemMapper (#NAV00006784).
* Deprecated RequestContextMapper (#NAV00003709).

Module stelvio-service:
* Changed throwing of exceptions in LazyObjectGraphloader from checked to unchecked.(#NAV00025631)


Version 1.0.5.6 (29.11.2007 )
-----------------------------
Module stelvio-common
stelvio-common-context
* Improved logging in AbstractInitRequestContextInterceptor (#NAV00023862)

Module stelvio-presentation
* Added class to FacesContextMessageSource to be used for handling messages in FacesContext (Requires message bundles to be added in faces-config.xml) (#NAV00022401)
* Deprecated class FacesContextMessages (#NAV00024510)
* Fixed default value for CodesTableItemSelectOneMenu when used in a MessageSource(#NAV00018824)


Version 1.0.5.5 (14.11.2007)
-------------------------------
Module stelvio-common:
stelvio-common-error
* ExceptionHandlerStrategyChain will now continue executing strategies in chain if one or more strategies fail. If strategies fail, it will always execute
  the FallbackExceptionHandler as well before returning (#NAV00020661)
* Added possibility to set different internal loggers in  LoggerExceptionHandlerStrategy(#NAV21427)
* toString() method in Stelvio exceptions are no longer finalized (SIR#NAV00022329->#NAV00022332)
* Added new unchecked wrapper exceptions that can be used as exception base classes in applications: ImplementationException, OperationalException (#NAV00019989)

Module stelvio-consumer:
* Fix timeout issue for LTPA token in consumer facade base (#NAV00021914)

Module stelvio-presentation:
stelvio-presentation-security
* Create a servlet filter which binds the HttpSession with the current authenticated user to prevent potential HttpSession hijacking (#NAV00022894).
  NOTE: In an application, this filter should ALWAYS be the first filter in the filterchain.
  
Changes in version 1.0.5.4 (01.11.07)
-----------------------------------
Module stelvio-common:
stelvio-common-error
* ExceptionHandlerStrategyChain will now continue executing strategies in chain if one or more strategies fail. If strategies fail, it will always execute the FallbackExceptionHandler
  as well before returning (#NAV00020661)
* LoggerExceptionHandlerStrategy is more robust, will log messages even when ErrorDefinitionResolver isn't working (or hasn't been injected)(#NAV00020628).
* LoggerExceptionHandlerStrategy now uses the  classname where the exception was created as the name of the logger instead of always using LoggerExceptionHandlerStrategy as the logname,
  making it easier to monitor the logs based on the origin of the exception (#NAV00020865).
* New component NullErrorDefinitionResolver, will always return null when resolve(Throwable) is called. 
  Used by the framework only, when no other ErrorDefinitionResolver can be created. (NAV00020666)
* ErrorDefinitionResolverFactoryBean will revert to returning a NullErrorDefinitionResolver if ErrorDefinitionResolverFactoryBean 
  has been misconfigured or the underlying database is down. (NAV00020666)
* CommonExceptionLogic changed to retrieve userID from RequestContext instead of SecurityContext. Former solution would only work properly in presentation layer components (#NAV00020877).

stelvio-common-security
* Improved safety on usercontext-switching when generating LTPA-tokens for ESB-calls in SecurityHeader. (#NAV00019037)

Module stelvio-batch:
* New methods for throwing exceptions, using the type safe ExceptionHandlerFacede-methods. Old methods that are not type safe have been deprecated (#NAV00018944).
* New interceptor, BatchInitRequestContextInterceptor, to initialize the thread-bound RequestContext for Batch Jobs that aren't passed the RequestContext as a start-up parameter. (#NAV00018709)

Module stelvio-service:
* New component LazyObjectgraphLoader for initializing lazy loaded collections in the service layer before the object graph is detached (#NAV00021157)

Module stelvio-presentation:
stelvio-presentation-security
* Correct nullpointer exception (SIR#NAV00019574) in WasLogoutService. (#NAV00020094)
* SecurityContextFilter - Change filter after Security QA (SIR#NAV00019546) to build up SecurityContext directly from the request.getRemoteUser() call
  on every request and remove usage of HttpSession (#NAV00019758)
  NOTE! In Websphere Application Server the following option must be enabled for this to work:
  Security -> Secure administration, application, and infrastructure -> WebSecurity -> General Settings - > 'Use available authentication data when an unprotected URI is accessed'.

stelvio-presentation-swf
* New exceptionHandler, ErrorPageExceptionHandler, and flowExecutionListener, ExceptionHandlerFlowExecutionLister, to correct problems with error handling in Spring Web Flow (#NAV00020904)
* Fixed problems with ErrorAction (#NAV00020906)



Changes in version 1.0.5.3 (03.10.2007)
---------------------------------------
* Updates to code checklists, PP17_GDMA_32(#NAV00017198)

Module stelvio-common:
* Make Bbanvalidator accessible (SIR#NAV00016395)
* Removed the dependency to the stelvo-common test classes from the Common, Provider and Service projects (#NAV00004339, #NAV00016987)
* Changed framework classes that use context holders(i.e. SecurityContextHolder, RequestContextHolder, ServiceRequest), 
  to use non-deprecated context methods(#NAV00018262)

stelvio-common-codestable:
* Changed hierarchy for exeptions that inherited wrong base exception (#NAV00017550)
* Added interface methods for retrieval of item sets for periodic codestableitems (CR#NAV00016823)

stelvio-common-context:
* Changed loglevels in PrepareServiceRequestInterceptor(#NAV00016957)

stelvio-common-error:
* Fixed order in ExceptionHandlerStrategyChain(SIR#NAV00016677)
* Added ClassNameErrorDefinitionResolver for easier error definition that does not instantiate all exception classes (#NAV00016722)
* Chain strategy must handle that the order of applied strategies are not set(SIR#NAV00016677)
* LoggerExceptionHandlerStrategy now supports setting log name through the new setLogName-method (#NAV00017601)
* Base class of InvalidArgumentException changed to FunctionalUnrecoverableException(#NAV00017388)
* Deprecated type unsafe throwNew(...)-methods in ExceptionHandler(#NAV00017136)

stelvio-common-security
* Added namespace information to the SOAP header element created in ConsumerContextHandler(#NAV00016565)

stelvio-common-transferobject:
* Moved PrepareServiceRequestInterceptor and ExecuteServiceRequestInterceptor here. Deprecated old locations (#NAV00017139)

Module stelvio-domain
* Implemented the Comparable interface in the MenuItem class, in order to ensure the ordering of a MenuItems children. MenuItems 
  are sorted according to the order attribute (#NAV00017566)
* Implemented proper toString() in ChangeStamp (#NAV00017433)

Module stelvio-presentation
* Changed the way the flow session is retrieved in RequestContextPhaseListener in order to prevent exceptions from beeing thrown
  from Spring Web Flow. These exceptions may cause flow execution locks (#NAV00017592)
* Added new constructor in PagedSortableList that in addition to the already existing constructor accepts a boolean value to decide
  whether the list should be ascending og descending (#NAV00017635)
* Fixed problem with nullpointer exeptions for columns with null values in PagedSortableList (#NAV0017804)


Changes in version 1.0.5.2 (11.09.2007)
---------------------------------------
General
* Upgraded the Spring framework dependencies to version 2.0.4

Module stelvio-domain-java
* Removed the attribute acceptSpecialCircumstance

Changes in version 1.0.5.1 (06.09.2007)
---------------------------------------

Module stelvio-common-java
* Update the compareTo method in AbstractCodesTablePeriodicItem to compare null values correctly (#NAV00008124)
* PrepareServiceRequestInterceptor no longer causes NullPointerException (#NAV00008660)
* LoggerExceptionHandlerStrategy now logs the exception in addition to the exception message. This makes it possible to log the stacktrace with log4j. (#NAV00008772)

Module stelvio-domain-java
* Made method get4DigitYearOfBirth in Pid public (#NAV00010141)

Module stelvio-presentation-java
* Removed all classes dependent upon Spring Web Flow, and moved these into the new module stelvio-presentation-swf-java
* Removed the Spring Web Flow dependency from pom.xml 

Module stelvio-provider-java
* Added debug statements to MorphToSdk14ExceptionHandlerStrategy to the debugging process for developers. (#NAV00009592)

Module stelvio-dto-java
* Updated RequestcontextDto to reflect changes made to RequestContext in Stelvio Common release 1.0.5 (#NAV00008646)

Module stelvio-presentation-security-page (merged in from Stelvio 1.0.4.9)
* Updated page security classes to better cope with Spring WebFlow (#NAV00006194)
  - JeeSecurityPhaselistener
  - Added ExternalViewIdExtractor - an interface to no.stelvio.presentation.jsf.security.webflow.WebflowViewIdExtractor.java
* Updated and added several classes for better error handling in the page security components,
  in particular the JeeSecurityPhaselistener (#NAV00001882)

New Module stelvio-presentation-swf-java
* Created this new module, it should contain all classes that depends on Spring Web Flow.
* Moved the classes ErrorAction.java and RequestContextPhaseListener.java from stelvio-presentation-java and into this module
* Moved the classes SecurityFlowNavigationHandler.java and WebFlowViewIdExtractor.java from stelvio-presentation-java (in Stelvio 1.0.4.9) into this module

New Module stelvio-presentation-eai (merged in from Stelvio 1.0.4.9)
* Added classes to support authentication through an External Authentication Interface (EAI) and WebSEAL, a reverse-proxy from IBM's Tivoli suite.


Changes in version 1.0.5 (27.08.07)
-----------------------------------

Module stelvio
* Updated the layer models in Confluence(#NAV00006774)
* Updated RSA UML model (#NAV00005988)

Module stelvio-consumer-java 
* Reorganized consumer support classes to new package locations. Deprecated the old ones (#NAV0005802)
  - no.stelvio.consumer.ConsumerSystemException->  no.stelvio.consumer.exception.ConsumerSystemException
  - no.stelvio.consumer.support.ConsumerContextHandler->no.stelvio.consumer.ws.ConsumerContextHandler
  - no.stelvio.consumer.support.ConsumerFacadeBase->no.stelvio.consumer.ws.ConsumerFacadeBase
  - no.stelvio.consumer.support.LTPASecurityHandler->no.stelvio.common.security.ws.LTPASecurityHandler
  - no.stelvio.consumer.support.SecurityHeader->no.stelvio.common.security.ws.SecurityHeader

Module stelvio-domain-java
* Modified the validation of Pid to allow for special circumstances when requested to do so using a flag.Special circumstances are where the personnummer is 00000 or 00001 (#NAV00007037)

Module stelvio-presentation-java
* Upgraded the MyFaces libraries to 1.1.5 (#NAV00004897)
* Updated architecture principles for Spring Work Flow (#NAV00006078)
* Upgraded the Spring Work Flow to 1.0.4 (#NAV00004526, #NAV00005439)
* New JSF-converter for enum classes (#NAV00005389, #TD170)

Module stelvio-provider-java
* Updated dependencies to test packages in stelvio-common (#NAV00004510)
* Resolved problem with mapping of RuntimeExceptions. Modified provider to allow for mapping of checked exceptions via Dozer (#NAV00001618)

Module stelvio-star-example
* Excluded el-sun from the JEE libraries and the web manifest file (#NAV00005440)
* Renamed provider layer classes according to the naming standards (#NAV00003271)

Changes in version 1.0.4.10 (TBD)
-----------------------------------
stelvio-common-codestable
* Added getter for id-field in IdAsKeyCodesTableItem and IdAsKeyCodesTablePeriodicItem (#NAV00008941)

stelvio-common-error
* Added passing of throwable to log4j-calls in LoggerExceptionHandlerStrategy (see logMessage method)


Changes in version 1.0.4.8 (23.08.07)
-------------------------------------

Module stelvio-domain-java 
* Modified the validation of Pid to allow for special circumstances where the personnummer is 00000 or 00001. (#NAV0007013)



Changes in version 1.0.4.7 (16.08.07)
-------------------------------------

Module stelvio-common-java
stelvio-common-codestable
* Support for codestables that can be filtered according to valid historical date. Two new methods added to AbstractCodesTable for retrieving CodesTableItems for 
  specified day, and for today. (#NAV00003126)
* Changed hashCode implementation in AbstractCodesTableItem(#NAV00005403) and AbstractCodesTablePeriodicItem(#NAV00005262)
* New component DecodeComparator for sorting Lists (not Sets) of CodesTableItems according to decode.

stelvio-common-config
* New component ExecuteServiceRequestInterceptor to support copying of RequestContext from ServiceRequest at the client to the RequestContextHolder. (#NAV00003380)
* New component ComponentIdHolder for configuring a component id
* New schema for easy configuration of Stelvio component.
* New properties on Requestcontext accessible through getUserId and getComponentId, deprecated getProcessId

stelvio-common-context
* New components to support copying of RequestContext from RequestContextHolder at the client to the ServiceRequest. (#NAV00003380)

stelvio-common-error
* Changes made to StaticErrorDefinitionResolver and ErrorDefinitionResolverFactoryBean to support multiple ErrorDefinitions
  in the database for each Exception class. (One definition per number of arguments passed to Exception)  (#NAV00005442)

Module stelvio-consumer-java
* Support for ApplicationId in SOAP header (#NAV00005432)

Module stelvio-domain-java 
* Modified the validation of PID to allow for special circumstances where the personnummer is 00000 or 00001. (#NAV00006391, #NAV00004074, #NAV00005167)
* Fixed calculateAge to calculate the age correctly(#NAV00006260)

Module stelvio-presentation-java
* NullpointerException in RequestContextPhaseListener, added an additional check in order to prevent the NullpointerException (#NAV00006344) 
* Added @id annotation to the EnumConverter class (#NAV00005677)
* Added a generic converter for enum classes, for conversion from Enums to String and vice versa. (#NAV00003132)
* Added CodesTableItemSelectOneMenu, a custom component for populating dropdown lists with elements from
  a given codes table item or codes table item periodic class. Also added faces-config.xml configuration
  for this component making it redundant to add the component definition in the application specific 
  faces-config.xml configuration file. (#NAV00003131)
* RequestContextFilter sets ComponentId on Requestcontext
* SecurityContextFilter sets userId on RequestContext



Changes in version 1.0.4.6 (24.07.07)
-----------------------------------
Module stelvio-common-java
stelvio-common-codestable
* CodesTable now supports CodesTablePeriodicItems with same code but different decodes as long as the periods don't overlap. (#NAV00005277)


Changes in version 1.0.4.5 (09.07.07)
-----------------------------------

Module stelvio-common-java
stelvio-common-codestable
* Fixed problem with the comparable implementation in CodesTableItem and CodesTablePeriodicItem (#NAV00005251)
* Fixed problem where equals in AbstractCodesTablePeriodicItem threw NullPointerException when toDate was null (#NAV00005226)
* Fixed AbstractCodesTablePeriodicItem equals so that exceptions won't occur when nulls are passed into the method (#NAV00003379)
* Implemented hashCode in AbstractCodesTablePeriodicItem (#NAV00005262)

stelvio-common-error
* DefaultExceptionHandlerFacade now only throws AlreadyHandledException in the case of throw new with an instance
  that has already been thrown.
* Made changes to Abstract exceptions to ease mapping between domain and dto exceptions

Module stelvio-provider-java
* Minor changes to MorphToSdk14ExceptionHandlerStrategy now checks for RecoverableDTOException

Module stelvio-provider-dto
* Made changes to Abstract DTO exceptions to ease mapping between domain and dto exceptions


Changes in version 1.0.4.4 (29.06.07)
-----------------------------------
Module stelvio-common-java
stelvio-common-codestable
* Fixed NullPointerException in DefaultCodesTablePeriodic with null-dataset (#NAV00004827)

Module stelvio-provider-java
* New component MorphToSdk14ExceptionHandlerStrategy to transform SE 5.0 exceptions to SE 1.4 compliant versions

Module stelvio-dto-java
* New component ImitatorDtoException to be thrown from the provider layer


Changes in version 1.0.4.3 (27.06.2007)
---------------------------------------

Module stelvio-common-java
stelvio-common-codestable
* Codestable components now support codes with leading numbers and/or non-alpha-numeric values when code-enums implement 
  and adapt the new interface no.stelvio.common.codestable.support.IllegalCodeEnum (#NAV00004625)

stelvio-common-config
* New component EnvironmentAwareResource to be used in conjuction with PropertyPlaceholderConfigurer to support looking up the environment in JNDI.

stelvio-common-error
* New component AbstractOrderedExceptionHandlerStrategy that may be subclassed for ExceptionHandlerStrategies that is to support ordering.
* MorpherExceptionHandlerStrategy now supports ordering of strategies that extend AbstractOrderedExceptionHandlerStrategy
  or directly implement org.springframework.core.Ordered
* The following strategies now support Ordering: ExceptionHandlerStrategyChain, FallbackExceptionHandlerStrategy
  EventPublisherExceptionHandlerStrategy, LoggerExceptionHandlerStrategy, MorpherExceptionHandlerStrategy



Changes in version 1.0.4.2 (20.06.2007)
---------------------------------------

Module stelvio-domain-java
* Changed the *-ToMany relationships in the Menu-component to be implemented using java.util.Set instead of java.util.List.
  This is a work around for a bug (HHH-1718) in Hibernate (#NAV00004552)


Changes in version 1.0.4.1 (18.06.2007)
---------------------------------------

Module stelvio-domain-java
* Changed the JPA mapping of the menuItems list in the MenuItemScreen class from "screens" to "menuItemScreens"


Changes in version 1.0.4 (25.05.2007)
-----------------------------------
General
* Fixed the maven build so it breaks if any of the unit tests fail
* Unit test guidelines and principles (extended version) (TD#244)
* Mocking guidelines and principles (initial version) (TD#243)
* Updated version of JUnit to JUnit4 (#NAV00001215)
* Updated mock and test libraries, Hamcrest 1.0 and JModk 2.0.0-RC1 (#NAV00001191)


Module stelvio-presentation-java
* RequestContextPhaseListener: added check to avoid nullpointerexception. (#NAV00001241)
* The error handling component ErrorAction now provides functionality to retrieve information about where the
  error occured. And the url of the start of the flow where the error occured can be provided. (Defect #33)
* Made it easier to add a message in a web page via FacesContext (TD#189)
* Decription of using inline Javascript (TD#283)

Module stelvio-presentation-help
* Architecture for context sensitive help, (TD#567)


Module stelvio-consumer-java
* Consumer facade interface for help information retrieval has been added, with request/response objects as well. (#NAV00002872)


Module stelvio-provider-java
* Specify how to be a provider to the integration architecture. The integration architecture imposes restrictions 
  in this respect, e.g. interface restrictions and no support for JDK 1.5. Must come up with and describe an 
  additional facade for business providers if no other options succeeds ,e.g. use a post-compiler. (TD#159)
* Prototype JDK1.4 and JDK 1.5 interoperability (TD#568)
* New stelvio-provider module, containing mapper classes for stelvio data objects(#NAV00001114)
* Added the stelvio-provider-java module (#NAV00000842)
* First release includes mappers for Pid/PidDto, ChangeStamp/ChangeStampDto, RequestContext/RequestContextDto, SecurityContext/SecurityContextDto (#NAV00001113)

Module stelvio-repository


Module stelvio-common-java
* Generating property files from Excel spreadsheets (TD#41)

stelvio-common-codestable
* Support for date filter (TD#145)
  Added CodesTablePeriodic.getDecode(...) methods which uses today's date and therefore do not need date as input
* Support for locale (TD#172 , #NAV00001362)
* Support for codestables without requirement for also maintaining the Enum implementations (TD#594->#NAV00002356)
* Support for sortable codestableitems (#NAV00002345)
* Support for codestables where code is not the key(#NAV00002358)
  Added CodesTable{Periodic}.getCodesTableItem(...) and CodesTable{Periodic}.getDecode(...) methods that takes a String
  as code; its validity will be checked by using Enum.valueOf(...)
* Check for overlapping time periods (TD#117, #NAV00002619)
* Remove obsolete hibernate test classes (#NAV00001211)
* Fixed error in codestable duplicate check (#NAV00003160)
* Support for codestable enums with numeric values (#NAV00001407)
* AbstractCodesTable could not find code table because of enumeration (#NAV00000804)
* Made CodesTable/CodesTablePeriodic iterable, that is, they can be used in the new for-each loop in JDK 5

stelvio-common-error
* Improved error handling 
  ErrorDefinition --> Fixed equals and hashcode to work on classname as this should always be set, even in unit tests
  LoggerExceptionHandlerStrategy --> Only log exception if it is not logged before
  StaticErrorDefinitionResolver --> Improved logging and use more specific exceptions
  AbstractCodesTableItem --> Made it possible to call utility method in more cases (#NAV00002641)
* Improve the name of the handle() method, saying more specifically what it does (that is, the exception specified 
  is caught by application code). (#NAV00002634)
* Make throwing a new exception typesafe and IDE-friendly (#NAV00002326)
* RuntimeExceptions being thrown from one layer to another, must be "removed" by Stelvio (#NAV00001593)
* Remove deprecated constructors for cloning exceptions (#NAV00001193)

stelvio-common-mapping
* Mapping framework description. (TD#398)
* Update Dozer dependency to version 3.3.1 (#NAV00003079)

stelvio-common-security
* Deprecated method getClassFromString() in class RoleValidatorUtil (#NAV00003259)

stelvio-common-util
* Added support for the date format ddMMyyyy in DateUtil.parseInputString (#NAV00001763)


Module stelvio-domain-java
* Added domain class for help content. (#NAV00002872)
* Date format error in Pid (#NAV00001045, additional date error to 1.0.3.1 release)
* Changestamp created-fields should not be updateable (#NAV00003305)
* Added calculateAge method to Pid (#NAV00001194)


Module stelvio-dto-java
* Data Transfer Objects for Stelvio domain objects
  New DTOs added: PidDto, ChangeStampDto, RequestContextDto, SecurityContextDto (#NAV00001107)
* Added DTO for many of the exceptions available in Stelvio.
* All instance state in Stelvio exceptions must be mapped in provider and consumer layers (#NAV00002451)
* Added base CodesTableItemDto (#NAV00003080)
* The dto layer is now JDK 1.4 compliant (#NAV00002409)

Module stelvio-batch-java
* Now supports parallel batches by including the slice variable. 
  New attributes in BatchDO to support parallel batches: slice, sliceStart, sliceEnd.
  Primary key in BatchDO is now a database generated key while the combination of batchName and slice is unique and to be used 
  as the unique identifyer in code 
  Minor changes to column mapping for some attribues (TD#569)
* Enhancements to error handling and logging: 
  Methods for logging have been deprecated
  New utility methods for throwing exceptions 
  New required property in AbstractBatch; exceptionHandler 
  Introduced base classes for batch related exceptions; BatchFunctionalException and BatchSystemException. (TD#570)
* New component BatchProgressEvent for progress reporting using the event architecture. New component 
  LoggerBatchProgressEventListener used to handle and BatchProgressEvents by the way of logging (TD#572)
* Enhancement to transaction handling and LUWs (TD#571)
* Added mapping of changestamp fields to BatchDo (#NAV00003231) 


Module stelvio-star-example
* Added modules for the provider layer (stelvio-provider-star-example-ejb, stelvio-provider-star-example-ejbclient, 
  stelvio-provider-star-example-java) 
  Added module for the dto layer (stelvio-dto-star-example-java) (#NAV00002348)




Changes in version 1.0.3.1 (12.04.2007)
------------------------------------

Module stelvio-common-java
* Fixed bug in getCodesTableItems. CodestableItems were represented in a hashmap as <enum, codestableitem>, but a String 
  variable was used as a key to retrieve the codestableitem (Defect #591, #NAV00001192)


Changes in version 1.0.3 (15.3.2007)
------------------------------------

Module stelvio-common-java
* Introduced NoGenericsCodesTableFactory to be used by EJBs that can't expose Generic types in component interface
* Introduced new component, NoGenericsCodesTableAdapter used to bridge the CodesTableFactory/NoGenericsCodesTableFactory gap
* Introduced IbanValidator used to validate International Bank Account Numbers
* Introduced BbanValidator used to validate Basic Bank Account Numbers (only supports Norwegian BBANs at the moment)
* Introduced RoleValidator and role definitions used to validate the roles sent in to rolechecks.
* Added a RoleValidator util which can create a RoleValidator on the basis of an enumeration of roles implementing
  the ValidRole interface.
* Added the possibility to use enumerations containing roles in the SecurityContext and the possibility to use
  a RoleValidator in the SimpleSecurityContext so that input parameters can be validated.
* Deprecated the set and reset methods of the SecurityContextHolder and RequestContextHolder as these methods
  should not be called from client code. Added setter classes in the support package which through reflection
  can invoke these. Intended for unit-testing only.

Module stelvio-dto-java
* New module added. No content in this release

Module stelvio-presentation-java
* Deprecated MenuAction, when descretion is to be implemented, this class will need to reside in the pensjon project. Defect #5
* Added LocalePhaseListener, a phaselistener that retrieves the current locale from FacesContext and sets it in the
  Spring LocaleContextHolder. Defect #342
* Changed RequestContextPhaseListener to avoid nullpointerexception. The phaselistener is no longer executed in the
  first phase of the lifecycle.
* Guideline for message now includes guidelines for the usage of text elments across funtional areas. Defect #408
* Errors in helpPopUp component has been corrected. Defect #485 and #486
* Architectural principles for the usage of the Valang validation framework has been added to the development handbook
  in the pension project. Defect #544
* Error handling component for the presentation layer for use in error pages has been added. Defect #33
* Implemented optional RoleValidation in the setup of the SecurityContext in the SecurityContextFilter. 
  An optional init parameter can be set specifying an enumeration containing the valid roles of the application.
  This will then be injected into the SecurityContext meaning that all components using the SecurityContext
  will be subject to rolevalidation against application-specific roles.

Module stelvio-consumer-java
* Contains support classes for creating consumer services. See the Guideline - Stelvio - Consumer for more information.


Changes in version 1.0.2 (15.2.2007)
------------------------------------

General
* Consumer integration is now in a separate stelvio-consumer layer. Updates and additions to 
  architecture documentation, guidelines and naming standards regarding this layer.
* Added version history and roadmap pages to Confluence
* Menu- and tasklist- taglibs have been moved out of Stelvio into pension project modules.
* Updates to guideline for stelvio-service with regards to use of transfer objects and configuring EJBs.
* Additions to stelvio-service naming standards with regards to naming of EJB classes and interfaces.

Library updates:
* Upgraded Spring to version 2.0.2
* Upgraded Spring WebFlow to version 1.0.1
* Upgraded Spring Modules Cache to version 0.7
* Upgraded Spring Modules Validation to version 0.7

Module stelvio-common-java
* Added support for validating that a code is present in a codes table [Defect #265]
* Usage of Locale in codes table items have been deprecated; internationalization of decodes will be handled by standard
  jdk support (properties files) [Defect #217]
* Made ServiceRequest and ServiceResponse abstract to explicitly state that they are base classes that must be extended
* Methods on ServiceRequest for setting/retrieving RequestContext are deprecated as client code should not work with
  RequestContext directly; access it through RequestContextHolder instead
* Deprecated TransferObject in favour of ServiceRequest/ServiceResponse
* getItems, getCodesTableItem, getDecode(Object) and getDecode(Object, Locale) in CodesTable have been deprecated
* Added the methods getDecode(Enum), getDecode(Enum, Locale) and validateCode(Enum) in CodesTable
* User id moved from RequestContext to SecurityContext.
* Made ServiceRequest and ServiceResponse abstract to explicitly state that they are base classes that must be extended

Module stelvio-domain-java
* Deprecated all sak-related domain classes, these hva been moved into the pensjon project

Module stelvio-repository-java
* Deprecated all sak-related repository classes, these have been moved into the pensjon project

Module stelvio-batch-java
* AbstractBatch implementation changed; retrival and update of BatchDO is now done through BatchRepository [Defect #55]
* Created new Exceptions to be used by Batch. [Defect #53]
* Batch now throws subclasses of BatchException [Defect #53]
* Added FileIdentity component to the batch framework [Defect #99]

Module stelvio-service-java
* Deprecated TasklistService and DefaultTasklistService. These have been moved to the pensjon project

Module stelvio-presentation-java
* The menu taglib has been moved moved to the pension project application framework.
* Upgraded Spring Modules Validation to 0.7
* Components for help taglib has been added. The taglib consist of three components: HelpDisplayAreaComponent,
  HelpInPageComponent and HelpPopUpComponent. These components also have a common HelpUtils class, with package locale
  utility metodes used by the help components. Resources for these components has been added to src/main/resources. 
* Added two classes for handling resources in pages, StelvioResourceHandler and StelvioResourceLoader. These are used by
  the help components.
* Added a faces-config.xml with definitions of the custom stelvio components under src/main/resources/META-INF
* Removed MenuComponent and MenuItemComponent. The menus used in stelvio should be based on the tomahawk panelNavigation2 
  component.
* Added a custom action class for fetching menu items and convert them into panelnavigation items used by the 
  panelNavigation2 component.

Star example
* Corrected package structure (no.nav.<x>.. -> no.stelvio.<x>.star.example...)
* Added consumer layer

Changes in version 1.0.1 (17.1.2007)
------------------------------------

General
* Added module stelvio-star-example which will hold a complete example of an implementation of a JEE application based
  on the Stelvio application architecture
* Added module stelvio-service-java
* Added module stelvio-repository-java

Module stelvio-common-java
* Added configuration (using the configuration mechanism defined by the JAR file service provider contract in JDK 1.3
  and above) in META-INF/services/org.apache.commons.logging.LogFactory to make sure commons-logging is using an
  application's log4j.properties and not Websphere's own
* Removed remnants of rtv-framework
* Refactored the 2 aspects of RequestContext, current thread handling and data container, into 2 new classes
  * RequestContext -> plain POJO holding specific values, like user id, screen id, etc
  * RequestContextHolder -> holds a RequestContext on the current thread
* Simplified transfer object support
  * No need for Entity(List)Response
  * No need for interfaces
  * 2 concrete classes, ServiceRequest and ServiceResponse, are left -> should be extended by transfer objects
* Cleaned up codes table code
  * Removed deprecated methods
  * Added getItems() on CodesTablePeriodic so the interface is equal to CodesTable
  * Improved documentation of which exceptions are thrown 
* Improved naming and structure of Error package
* No need to implement a constructor only used by Stelvio when removing cause; reflection is used instead
* Created a Stelvio SecurityContext which holds the user id and has methods for role checking
* Column mapping in CodesTable domain classes changed from Norwegian to English; should be overridden using
  AttributeOverride annotations in subclasses
* Fixed CodesTableFactory to generate a CodesTable/CodesTablePeriodic instead of returning a list
* Added Id annotation to indicate primary key; is placed in the top level mapped superclass as it should be the key for
  all codestables
* Fixed usage of serialVersionUID in CodesTable exception classes
* Model id for the CodesTable cache is changed to enable easier separation from other caches
* Split SecurityContext and RequestContext into interface and implementation to enable easier testing and extension
* Removed user id from RequestContext as it is in SecurityContext
* Added builder to RequestContext which makes it easier to build a new instance of it, especially when one should only
  update some of the properties in the current version
* Removed unused classes
* Cleanup of package structure for easier use

Module stelvio-test-java
* Fixed package structure (no.stelvio.common.test -> no.stelvio.test)

Module stelvio-domain-java
* Added domain object Pid, used to represent a Personal Identification number. Includes validation methods.
* Moved domain objects in common for menu here
* Moved domain objects in common for tasklist here
* Removed constructor fron PidValidationException using deprecated ExceptionCopyholder

Module stelvio-repository-java
* Moved repository classes in common for menu here
* Moved repository classes in common for tasklist here 
* Added repository classes for CodesTable
* Changed method signature in CodesTable classes, using generics to specify that the class passed as a param to the
  fetchCodesTable method must be an AbstractCodestableItem implementation
* Added full Hibernate implementation of CodesTableRepository

Module stelvio-batch-java

Module stelvio-service-java
* Moved service classes in common for menu here
* Moved service classes in common for tasklist here
* Added implementation of CodesTableFactory that retrieves codes tables from a repository
* Added MenuItemServiceResponse object to be used by MenuService
  * Is used in MenuItemService instead of deprecated EntityListResponse as the return value

Module stelvio-presentation-java
* Renamed package from no.stelvio.web to no.stelvio.presentation
* Removed remnants of rtv-framework
* Added no.stelvio.presentation.jsf.event.RequestContextPhaseListener, this phaselistener is responsible for updating 
  the screenId in the RequestContext object. This used to be done in RequestContextFilter, but this caused a 
  NullPointerException because the filter runs before the FacesContext and SWF Context are initialized. 
* Added no.stelvio.presentation.constants.ConstantsWrapper. Wrapper class for handling constants in the presentation 
  layer. Provides functionality to extract constants from a given class as a map.
* Added SecurityContextFilter and its parse classes; this filter initializes the SecurityContext
* Cleanup of package structure for easier use
* Fixed class names in security packages to support the naming standard
  * Also changed to use Jee (earlier J2ee) in class names as Stelvio is running mostly on a JEE platform now
* Changed all filters to inherit from Spring's OncePerRequestFilter instead of our own deprecated filter super class
* Updated page security to use the SecurityContext instead of the HttpServletRequest for security checks

Star example
* Added namedquery to retrieve all HenvendelseTypeCti from database
* Moved repository classes for CodesTable to stelvio-repository
* Changed table-mapping; physical database uses T_ prefix for tables
* Column mapping names should be in upper case
* Added integration test of CodesTable APIs
* Use saksbehandling as the package name, not psak; moved all code used in psak over til saksbehandling


